import{_ as A,A as C,r as v,f as q,d as B,c as d,a as t,w as o,v as r,h as m,F as y,i as g,q as E,z as H,m as k,u as I,o as i,t as w}from"./index-BBkAQfZn.js";import"@/assets/main.css";const P={class:"p-6 bg-white shadow rounded overflow-y-auto h-full"},R={class:"flex gap-2"},z=["value"],L=["value"],N=["value"],T={__name:"EditPatient",setup(j){const V=C(),b=I(),x=V.params.id,a=v({name:"",birthday:"",gender:"",emergencyContact:"",address:"",patientDetail:"",allergies:"",familyHistory:"",currentMedications:""}),M=new Date().getFullYear(),U=Array.from({length:100},(s,e)=>M-18-e),n=v(""),u=v(""),p=v(""),S=q(()=>{if(!n.value||!u.value)return[];const s=new Date(n.value,u.value,0).getDate();return Array.from({length:s},(e,l)=>l+1)}),c=async()=>{try{const s=await k.get(`/patient/${x}`);a.value=s.data;const e=new Date(a.value.birthday);n.value=e.getFullYear(),u.value=e.getMonth()+1,p.value=e.getDate()}catch{alert("讀取失敗"),b.push("/user-center/patients")}},F=async()=>{var D;if(!n.value||!u.value||!p.value){alert("請完整選擇生日");return}const s=String(u.value).padStart(2,"0"),e=String(p.value).padStart(2,"0");a.value.birthday=`${n.value}-${s}-${e}`;const l=new Date(a.value.birthday),f=new Date;if(f.getFullYear()-l.getFullYear()-(f<new Date(f.getFullYear(),l.getMonth(),l.getDate())?1:0)<18){alert("患者必須年滿 18 歲");return}try{await k.put(`/patient/update/${x}`,a.value),alert("更新成功"),b.push("/user-center/patients")}catch($){alert(((D=$.response)==null?void 0:D.data)||"更新失敗")}},Y=()=>{b.push("/user-center/patients")};return B(c),(s,e)=>(i(),d("div",P,[e[25]||(e[25]=t("h2",{class:"text-xl font-bold mb-4"},"編輯患者",-1)),t("form",{onSubmit:H(F,["prevent"]),class:"space-y-4"},[t("div",null,[e[11]||(e[11]=t("label",{class:"block font-medium mb-1"},"姓名",-1)),o(t("input",{"onUpdate:modelValue":e[0]||(e[0]=l=>a.value.name=l),type:"text",class:"w-full border rounded p-2",required:""},null,512),[[r,a.value.name]])]),t("div",null,[e[15]||(e[15]=t("label",{class:"block font-medium mb-1"},"生日",-1)),t("div",R,[o(t("select",{"onUpdate:modelValue":e[1]||(e[1]=l=>n.value=l),class:"border rounded p-2"},[e[12]||(e[12]=t("option",{value:""},"年",-1)),(i(!0),d(y,null,g(E(U),l=>(i(),d("option",{key:l,value:l},w(l),9,z))),128))],512),[[m,n.value]]),o(t("select",{"onUpdate:modelValue":e[2]||(e[2]=l=>u.value=l),class:"border rounded p-2"},[e[13]||(e[13]=t("option",{value:""},"月",-1)),(i(),d(y,null,g(12,l=>t("option",{key:l,value:l},w(l),9,L)),64))],512),[[m,u.value]]),o(t("select",{"onUpdate:modelValue":e[3]||(e[3]=l=>p.value=l),class:"border rounded p-2"},[e[14]||(e[14]=t("option",{value:""},"日",-1)),(i(!0),d(y,null,g(S.value,l=>(i(),d("option",{key:l,value:l},w(l),9,N))),128))],512),[[m,p.value]])])]),t("div",null,[e[17]||(e[17]=t("label",{class:"block font-medium mb-1"},"性別",-1)),o(t("select",{"onUpdate:modelValue":e[4]||(e[4]=l=>a.value.gender=l),class:"w-full border rounded p-2",required:""},e[16]||(e[16]=[t("option",{value:""},"請選擇",-1),t("option",{value:0},"女性",-1),t("option",{value:1},"男性",-1)]),512),[[m,a.value.gender]])]),t("div",null,[e[18]||(e[18]=t("label",{class:"block font-medium mb-1"},"緊急聯絡",-1)),o(t("input",{"onUpdate:modelValue":e[5]||(e[5]=l=>a.value.emergencyContact=l),type:"text",class:"w-full border rounded p-2"},null,512),[[r,a.value.emergencyContact]])]),t("div",null,[e[19]||(e[19]=t("label",{class:"block font-medium mb-1"},"地址",-1)),o(t("input",{"onUpdate:modelValue":e[6]||(e[6]=l=>a.value.address=l),type:"text",class:"w-full border rounded p-2"},null,512),[[r,a.value.address]])]),t("div",null,[e[20]||(e[20]=t("label",{class:"block font-medium mb-1"},"病患詳情",-1)),o(t("textarea",{"onUpdate:modelValue":e[7]||(e[7]=l=>a.value.patientDetail=l),rows:"3",class:"w-full border rounded p-2"},null,512),[[r,a.value.patientDetail]])]),t("div",null,[e[21]||(e[21]=t("label",{class:"block font-medium mb-1"},"過敏史",-1)),o(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=l=>a.value.allergies=l),rows:"3",class:"w-full border rounded p-2"},null,512),[[r,a.value.allergies]])]),t("div",null,[e[22]||(e[22]=t("label",{class:"block font-medium mb-1"},"家族病史",-1)),o(t("textarea",{"onUpdate:modelValue":e[9]||(e[9]=l=>a.value.familyHistory=l),rows:"3",class:"w-full border rounded p-2"},null,512),[[r,a.value.familyHistory]])]),t("div",null,[e[23]||(e[23]=t("label",{class:"block font-medium mb-1"},"目前用藥",-1)),o(t("textarea",{"onUpdate:modelValue":e[10]||(e[10]=l=>a.value.currentMedications=l),rows:"3",class:"w-full border rounded p-2"},null,512),[[r,a.value.currentMedications]])]),t("div",{class:"flex space-x-4"},[e[24]||(e[24]=t("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600"}," 儲存修改 ",-1)),t("button",{type:"button",onClick:Y,class:"bg-gray-500 text-white px-4 py-2 rounded hover:bg-gray-600"}," 取消 ")])],32)]))}},O=A(T,[["__scopeId","data-v-aa7bc807"]]);export{O as default};
