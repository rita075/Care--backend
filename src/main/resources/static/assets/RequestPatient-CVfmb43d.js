import{B as w,C as V,_ as D,r as U,f as M,d as q,c as u,g as B,a as e,w as v,h as $,F as c,i as g,v as f,q as r,j as o,t as l,u as j,o as d,l as h}from"./index-BBkAQfZn.js";import{u as N}from"./AppointmentStore-B5xb3BvQ.js";import"@/assets/main.css";const F=w("patient",{state:()=>({myPatients:[],loading:!1,error:null}),actions:{async fetchMyPatients(){this.loading=!0,this.error=null;try{const p=await V.get("/patient/my",{withCredentials:!0});p.status===200?this.myPatients=p.data:this.error=`載入病患資料失敗：${p.status} - ${p.data}`}catch(p){this.error=`載入病患資料時發生錯誤：${p.message}`}finally{this.loading=!1}}},getters:{getPatientById:p=>a=>p.myPatients.find(m=>m.patientId===a)}}),L={class:"wrapper"},R={class:"container"},z={class:"main-section"},E={class:"card-section"},W={class:"form-item"},A=["value"],_={class:"form-item"},G={class:"checkbox-group"},H=["value"],J={class:"form-item"},K={class:"checkbox-group"},Q=["value"],X={class:"form-item"},Y={class:"checkbox-group"},Z=["value"],tt=["disabled"],et={class:"sidebar"},st={class:"card-section"},nt={key:0},lt={key:0},it={key:1},ot={key:1},at={__name:"RequestPatient",setup(p){const a=N(),m=F(),I=j(),s=U({patientId:"",diseases:[],diseaseOther:"",physicalConditions:[],physicalOther:"",services:[],serviceOther:""}),P=["中風","肺炎","骨折","帕金森氏症","手術照顧","高血壓","糖尿病","洗腎","癌症","精神疾病","失智症","其他"],T=["長期臥床","使用輔具","褥瘡","管路","腸造口/胃造口","自殘傾向","攻擊傾向","情緒低落","其他"],C=["協助進食","陪同外出","代購物品","環境整理","翻身拍背","身體清潔","大小便處理","協助移位","其他"],b=M(()=>m.myPatients);q(async()=>{try{await m.fetchMyPatients(),m.myPatients.length>0&&console.log("回來的病患資料：",m.myPatients)}catch(i){console.error("載入病患資料錯誤：",i)}});const k=i=>i?new Date(i).toLocaleString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}):"",O=i=>i?new Date(i).toLocaleDateString("zh-TW",{year:"numeric",month:"2-digit",day:"2-digit"}):"",x=i=>{if(!i)return"";const[t,n]=i.split(":");return`${t}:${n}`},S=()=>{if(!s.value.patientId)return;const i=b.value.find(t=>t.patientId===Number(s.value.patientId));i&&(console.log("設定病患資訊：",i),a.setPatientInfo({...i,diseases:s.value.diseases,diseaseOther:s.value.diseaseOther,physicalConditions:s.value.physicalConditions,physicalOther:s.value.physicalOther,services:s.value.services,serviceOther:s.value.serviceOther})),I.push("/request/location")};return(i,t)=>(d(),u("div",L,[t[27]||(t[27]=B('<div class="progress-bar" data-v-f8286572><div class="progress-step" data-v-f8286572><span class="circle" data-v-f8286572>1</span> 時間類型 </div><span class="progress-arrow" data-v-f8286572>&gt;</span><div class="progress-step active" data-v-f8286572><span class="circle" data-v-f8286572>2</span> 被照顧者資訊 </div><span class="progress-arrow" data-v-f8286572>&gt;</span><div class="progress-step" data-v-f8286572><span class="circle" data-v-f8286572>3</span> 服務地點 </div></div>',1)),e("div",R,[e("div",z,[e("div",E,[t[12]||(t[12]=e("h3",null,"被照顧者資訊",-1)),e("div",W,[t[8]||(t[8]=e("label",null,"選擇病患",-1)),v(e("select",{"onUpdate:modelValue":t[0]||(t[0]=n=>s.value.patientId=n),required:""},[t[7]||(t[7]=e("option",{value:"",disabled:""},"請選擇病患",-1)),(d(!0),u(c,null,g(b.value,n=>(d(),u("option",{key:n.patientId,value:n.patientId},l(n.name),9,A))),128))],512),[[$,s.value.patientId]])]),e("div",_,[t[9]||(t[9]=e("label",null,"疾病 (可複選)",-1)),e("div",G,[(d(),u(c,null,g(P,n=>e("label",{key:n},[v(e("input",{type:"checkbox",value:n,"onUpdate:modelValue":t[1]||(t[1]=y=>s.value.diseases=y)},null,8,H),[[h,s.value.diseases]]),o(" "+l(n),1)])),64))]),v(e("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=n=>s.value.diseaseOther=n),placeholder:"其他疾病補充"},null,512),[[f,s.value.diseaseOther]])]),e("div",J,[t[10]||(t[10]=e("label",null,"身體狀況 (可複選)",-1)),e("div",K,[(d(),u(c,null,g(T,n=>e("label",{key:n},[v(e("input",{type:"checkbox",value:n,"onUpdate:modelValue":t[3]||(t[3]=y=>s.value.physicalConditions=y)},null,8,Q),[[h,s.value.physicalConditions]]),o(" "+l(n),1)])),64))]),v(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=n=>s.value.physicalOther=n),placeholder:"其他身體狀況補充"},null,512),[[f,s.value.physicalOther]])]),e("div",X,[t[11]||(t[11]=e("label",null,"服務項目 (可複選)",-1)),e("div",Y,[(d(),u(c,null,g(C,n=>e("label",{key:n},[v(e("input",{type:"checkbox",value:n,"onUpdate:modelValue":t[5]||(t[5]=y=>s.value.services=y)},null,8,Z),[[h,s.value.services]]),o(" "+l(n),1)])),64))]),v(e("input",{type:"text","onUpdate:modelValue":t[6]||(t[6]=n=>s.value.serviceOther=n),placeholder:"其他服務補充"},null,512),[[f,s.value.serviceOther]])]),e("button",{class:"submit-btn",onClick:S,disabled:!s.value.patientId}," 確認預約單 ",8,tt)])]),e("div",et,[e("div",st,[t[26]||(t[26]=e("h3",null,"您的需求資訊",-1)),r(a).appointment.timeType?(d(),u("div",nt,[e("p",null,[t[13]||(t[13]=e("strong",null,"時間類型：",-1)),o(l(r(a).appointment.timeType==="continuous"?"連續時間":"多時段預訂"),1)]),r(a).appointment.timeType==="continuous"?(d(),u("div",lt,[e("p",null,[t[14]||(t[14]=e("strong",null,"服務開始：",-1)),o(l(k(r(a).continuous.startTime)),1)]),e("p",null,[t[15]||(t[15]=e("strong",null,"服務結束：",-1)),o(l(k(r(a).continuous.endTime)),1)])])):(d(),u("div",it,[e("p",null,[t[16]||(t[16]=e("strong",null,"服務開始日期：",-1)),o(l(O(r(a).multi.startDate)),1)]),e("p",null,[t[17]||(t[17]=e("strong",null,"服務結束日期：",-1)),o(l(O(r(a).multi.endDate)),1)]),e("p",null,[t[18]||(t[18]=e("strong",null,"每日開始時間：",-1)),o(l(x(r(a).multi.dailyStartTime)),1)]),e("p",null,[t[19]||(t[19]=e("strong",null,"每日結束時間：",-1)),o(l(x(r(a).multi.dailyEndTime)),1)])])),e("div",null,[e("p",null,[t[20]||(t[20]=e("strong",null,"選擇的病患：",-1)),o(l(r(a).appointment.patientInfo.name||"未選擇"),1)]),e("p",null,[t[21]||(t[21]=e("strong",null,"性別：",-1)),o(l(r(a).appointment.patientInfo.gender||"未提供"),1)])]),e("div",null,[e("p",null,[t[22]||(t[22]=e("strong",null,"疾病：",-1)),o(l(s.value.diseases.join("、"))+" "+l(s.value.diseaseOther),1)]),e("p",null,[t[23]||(t[23]=e("strong",null,"身體狀況：",-1)),o(l(s.value.physicalConditions.join("、"))+" "+l(s.value.physicalOther),1)]),e("p",null,[t[24]||(t[24]=e("strong",null,"服務項目：",-1)),o(l(s.value.services.join("、"))+" "+l(s.value.serviceOther),1)])])])):(d(),u("div",ot,t[25]||(t[25]=[e("p",{style:{color:"gray"}},"尚未填寫時間資訊，請返回上一步完成填寫。",-1)])))])])])]))}},pt=D(at,[["__scopeId","data-v-f8286572"]]);export{pt as default};
