import{_ as S,r as T,f as x,m as v,d as b,A as D,c as u,a as t,j as p,t as l,F as _,q as m,u as C,o as d}from"./index-BBkAQfZn.js";import{u as w}from"./caregiverStore-BzssTZa9.js";import{u as k}from"./AppointmentStore-B5xb3BvQ.js";import"@/assets/main.css";const $={class:"wrapper"},P={key:0,class:"caregiver-profile card-section"},R={class:"flex flex-col md:flex-row gap-8"},N={class:"flex-1 space-y-8"},E={class:"flex-shrink-0 relative"},A=["src","alt"],B={class:"text-3xl font-bold text-teal-700"},j={class:"info-grid"},F={class:"info-item"},O={class:"value"},J={class:"info-item"},q={class:"value"},z={class:"info-item"},M={class:"value"},V={class:"info-item"},G={class:"value"},H={class:"info-item"},K={class:"value"},L={class:"info-item"},Q={class:"value"},U={class:"info-item"},W={class:"value"},X={class:"text-gray-600 mt-3 leading-relaxed"},Y={class:"flex-1 space-y-6"},Z={class:"info-grid"},ee={class:"info-item"},te={class:"value"},ae={class:"info-item"},se={class:"value"},oe={class:"mt-4"},ie={class:"text-xl font-semibold text-teal-700"},le={key:1,class:"loading-state text-center py-12 bg-white rounded-lg shadow-sm"},re={__name:"CaregiverProfile",setup(ne){const g=C(),f=D(),r=w(),s=k(),a=T(null);x(async()=>{if(a.value&&a.value.caregiverId){console.log("Appointment Time Type in estimate:",s.appointment.timeType),console.log("Continuous data in estimate:",s.continuous);try{console.log("Fetching estimate price...");let o=null;if(s.appointment.timeType==="continuous"){const e=s.continuous,i=e.startTime?`${e.startTime}:00`:null,n=e.endTime?`${e.endTime}:00`:null,c=e.startDate&&i?`${e.startDate}T${i}`:null,I=e.endDate&&n?`${e.endDate}T${n}`:null;o=(await v.get("/api/appointment/estimate/continuous",{params:{caregiverId:a.value.caregiverId,startTime:c,endTime:I}})).data}else if(s.appointment.timeType==="multi"){const e=s.multi.multi,i=e.timeSlots.map(c=>({startTime:c.startTime?`${c.startTime}:00`:null,endTime:c.endTime?`${c.endTime}:00`:null}));o=(await v.get("/api/appointment/estimate/multi",{params:{caregiverId:a.value.caregiverId,startDate:e.startDate,endDate:e.endDate,repeatDays:e.repeatDays,timeSlots:i}})).data}return console.log("Estimate price fetched:",o),s.appointment.totalPrice=o,o!==null?`${o} 元`:"無法估價"}catch(o){return console.error("Failed to fetch estimate price in CaregiverProfile:",o),s.appointment.totalPrice=null,"無法估價"}}return"計算中..."}),b(async()=>{const o=f.params.id;if(console.log("Caregiver ID from route:",o),r.selectedCaregiver&&r.selectedCaregiver.caregiverId===parseInt(o))a.value=r.selectedCaregiver,console.log("Caregiver from store:",a.value);else if(o)try{const e=await v.get(`/api/caregivers/${o}`);a.value=e.data,r.selectCaregiver(e.data),console.log("Caregiver details fetched from API:",a.value)}catch(e){console.error("Failed to fetch caregiver details:",e)}else console.warn("No caregiver ID available.");s.appointment.timeType=localStorage.getItem("timeType")||"continuous",s.continuous.startDate=localStorage.getItem("continuousStartDate")||"",s.continuous.startTime=localStorage.getItem("continuousStartTime")||"",s.continuous.endDate=localStorage.getItem("continuousEndDate")||"",s.continuous.endTime=localStorage.getItem("continuousEndTime")||"",s.multi.multi.startDate=localStorage.getItem("multiStartDate")||"",s.multi.multi.endDate=localStorage.getItem("multiEndDate")||"";try{s.multi.multi.repeatDays=JSON.parse(localStorage.getItem("multiRepeatDays")||"{}"),s.multi.multi.timeSlots=JSON.parse(localStorage.getItem("multiTimeSlots")||"[]")}catch(e){console.error("Error parsing multi time data from localStorage:",e),s.multi.multi.repeatDays={},s.multi.multi.timeSlots=[]}if(r.selectedCaregiver)a.value=r.selectedCaregiver;else{const e=localStorage.getItem("selectedCaregiver");if(e)try{a.value=JSON.parse(e)}catch(i){console.error("Error parsing stored caregiver:",i),localStorage.removeItem("selectedCaregiver")}}if(!a.value){const e=f.params.caregiverId,i=r.caregivers.find(n=>n.caregiverId===e);i?(a.value=i,r.selectCaregiver(i),localStorage.setItem("selectedCaregiver",JSON.stringify(i))):(console.warn(`找不到 ID 為 ${e} 的看護`),a.value={})}});const y=()=>{g.push("/caregivers/list")},h=()=>{a.value&&a.value.caregiverId?(s.appointment.caregiverId=a.value.caregiverId,g.push(`/request/time?caregiverId=${a.value.caregiverId}`)):console.warn("無法確認預約，看護資料未載入。")};return(o,e)=>{var i,n;return d(),u("div",$,[t("button",{onClick:y,class:"back-button flex items-center text-teal-600 hover:text-teal-700 transition-colors duration-200","aria-label":"返回搜尋結果"},e[0]||(e[0]=[t("svg",{class:"w-5 h-5 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 19l-7-7 7-7"})],-1),p(" 返回搜尋結果 ")])),a.value?(d(),u("div",P,[t("div",R,[t("div",N,[t("div",E,[t("img",{class:"caregiver-image",src:a.value.photoPath||"https://finalimagesbucket.s3.amazonaws.com/default-placeholder.jpg",alt:`看護 ${a.value.caregiverName}`,loading:"lazy"},null,8,A)]),t("h1",B,l(a.value.caregiverName),1),t("div",j,[t("div",F,[e[1]||(e[1]=t("span",{class:"label"},"性別",-1)),t("span",O,l(a.value.gender||"未知"),1)]),t("div",J,[e[2]||(e[2]=t("span",{class:"label"},"國籍",-1)),t("span",q,l(a.value.nationality||"未知"),1)]),t("div",z,[e[3]||(e[3]=t("span",{class:"label"},"語言",-1)),t("span",M,[Array.isArray((i=a.value)==null?void 0:i.languages)?(d(),u(_,{key:0},[p(l(a.value.languages.join(", ")),1)],64)):(d(),u(_,{key:1},[p(l(((n=a.value)==null?void 0:n.languages)||"未知"),1)],64))])]),t("div",V,[e[4]||(e[4]=t("span",{class:"label"},"經驗年數",-1)),t("span",G,l(a.value.yearOfExperience)+" 年",1)]),t("div",H,[e[5]||(e[5]=t("span",{class:"label"},"時薪",-1)),t("span",K,l(a.value.hourlyRate?`${a.value.hourlyRate} 元/小時`:"未提供"),1)]),t("div",L,[e[6]||(e[6]=t("span",{class:"label"},"半日薪",-1)),t("span",Q,l(a.value.hourlyRate?`${a.value.halfDayRate} 元/小時`:"未提供"),1)]),t("div",U,[e[7]||(e[7]=t("span",{class:"label"},"日薪",-1)),t("span",W,l(a.value.hourlyRate?`${a.value.fullDayRate} 元/小時`:"未提供"),1)])]),t("div",null,[e[8]||(e[8]=t("h3",{class:"section-title"},"詳細介紹",-1)),t("p",X,l(a.value.description||"尚無詳細介紹"),1)])]),e[12]||(e[12]=t("div",{class:"divider"},null,-1)),t("div",Y,[e[11]||(e[11]=t("h3",{class:"section-title"},"您的需求",-1)),t("div",Z,[t("div",ee,[e[9]||(e[9]=t("span",{class:"label"},"服務縣市",-1)),t("span",te,l(m(s).appointment.city||"未選擇"),1)]),t("div",ae,[e[10]||(e[10]=t("span",{class:"label"},"時間需求",-1)),t("span",se,l(m(s).appointment.timeRequirements||"未提供"),1)])])])]),t("div",oe,[e[13]||(e[13]=t("h4",{class:"section-title"},"預估總價",-1)),t("p",ie,l(m(s).appointment.totalPrice!==null?`${m(s).appointment.totalPrice} 元`:"計算中..."),1)]),t("div",{class:"mt-8"},[t("button",{onClick:h,class:"booking-button w-full flex justify-center items-center py-3 bg-teal-600 text-white rounded-full font-medium hover:bg-teal-700 transition-all duration-200 transform hover:scale-105","aria-label":"確認預約"}," 立即預約 ")])])):(d(),u("div",le,e[14]||(e[14]=[t("div",{class:"animate-spin inline-block w-8 h-8 border-4 border-teal-600 border-t-transparent rounded-full"},null,-1),t("p",{class:"mt-4 text-lg text-gray-600"},"正在載入看護資料...",-1)])))])}}},pe=S(re,[["__scopeId","data-v-f758a3cf"]]);export{pe as default};
